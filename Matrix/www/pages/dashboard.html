<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>MatrixGym | Dashboard</title>
  <!-- Tell the browser to be responsive to screen width -->
  <meta content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" name="viewport">
  <!-- Bootstrap 3.3.6 -->
  <link rel="stylesheet" href="../css/bootstrap.min.css">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css">
  <!-- Ionicons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/ionicons/2.0.1/css/ionicons.min.css">
  <!-- DataTables -->
  <link rel="stylesheet" href="../plugins/datatables/dataTables.bootstrap.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../css/AdminLTE.min.css">
  <!-- AdminLTE Skins. Choose a skin from the css/skins
       folder instead of downloading all of them to reduce the load. -->
  <link rel="stylesheet" href="../css/skins/_all-skins.min.css">

  <link rel="stylesheet" href="http://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/css/toastr.css">

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
  <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
  <![endif]-->
  <style>
   #overlay {
    position: absolute;
    left: 0;
    top: 0;
    bottom: 0;
    right: 0;
    background: #000;
    opacity: 0.8;
    filter: alpha(opacity=80);
    display: none;
    z-index: 10000;
  }
  #loading {
      width: 50px;
      height: 57px;
      position: absolute;
      top: 50%;
      left: 50%;
      margin: -28px 0 0 -25px;
  }
  </style>
</head>
<body class="hold-transition skin-blue sidebar-mini fixed">
  <div id="overlay">
    <img id="loading" src="../img/loading.gif">
  </div>
<div class="wrapper" id="app-3">
  <header class="main-header">
      <!-- Logo -->
      <a href="dashboard.html" class="logo">
        <!-- mini logo for sidebar mini 50x50 pixels -->
        <span class="logo-mini"><b>M F</span>
        <!-- logo for regular state and mobile devices -->
        <span class="logo-lg"><b>Matrix</b> Fitness</span>
      </a>
      <!-- Header Navbar: style can be found in header.less -->
      <nav class="navbar navbar-static-top">
        <!-- Sidebar toggle button-->
        <a href="#" class="sidebar-toggle" data-toggle="offcanvas" role="button">
          <span class="sr-only">Toggle navigation</span>
        </a>

        <div class="navbar-custom-menu">
          <ul class="nav navbar-nav">
            <!-- User Account: style can be found in dropdown.less -->
            <li class="dropdown user user-menu">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                <img class="user-image profileimage" alt="User Image">
                <span class="hidden-xs uname"></span>
              </a>
              <ul class="dropdown-menu">
                <!-- User image -->
                <li class="user-header">
                  <img class="img-circle profileimage" alt="User Image">
                  <p><span class="uname"></span> - <span class="userrole"></span><small>Member since <span class="createdat"></span></small></p>
                </li>
                <!-- Menu Footer-->
                <li class="user-footer">
                  <div class="pull-left">
                    <a href="profile.html"><button class="btn bg-purple margin">Profile</button></a>
                  </div>
                  <div class="pull-right">
                    <a href="changepassword.html"><button class="btn bg-purple margin">Change Password</button></a>
                  </div>
                </li>
              </ul>
            </li>
          </ul>
        </div>
      </nav>
    </header>
  <!-- Left side column. contains the logo and sidebar -->
      <aside class="main-sidebar">
      <!-- sidebar: style can be found in sidebar.less -->
      <section class="sidebar">
        <!-- Sidebar user panel -->
        <div class="user-panel">
          <div class="pull-left image">
            <img class="img-circle profileimage" alt="User Image">
          </div>
          <div class="pull-left info">
            <p class="uname"></p>
            <p class="userrole"></p>
          </div>
        </div>
        <!-- sidebar menu: : style can be found in sidebar.less -->
        <ul class="sidebar-menu">
          <!--<li class="header">MAIN NAVIGATION</li>-->
          <li class="active">
            <a href="dashboard.html">
              <i class="fa fa-dashboard"></i> <span>Dashboard</span>
            </a>
          </li>
          <li class="treeview">
            <a href="#">
              <i class="fa fa-user"></i>
              <span>Customer</span>
              <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
            <ul class="treeview-menu">
              <li><a href="addcustomer.html"><i class="fa fa-plus"></i> Add Customer</a></li>
              <li><a href="editcustomer.html"><i class="fa fa-edit"></i> Edit Customer</a></li>
              <li><a href="customerlist.html"><i class="fa fa-list-alt"></i> Customer List</a></li>
              <li><a href="expiredcustomer.html"><i class="fa fa-list-ul"></i> Expired Customer</a></li>
              <li><a href="paymentduecustomer.html"><i class="fa fa-rupee"></i> Payment Due Customer</a></li>
              <li><a href="comingsoonexpirecustomer.html"><i class="fa fa-minus-square-o"></i> Coming Soon Expire Customer</a></li>
            </ul>
          </li>
          <li class="treeview" v-if="seen">
            <a href="#">
              <i class="fa fa-cog"></i>
              <span>Manage</span>
              <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
            <ul class="treeview-menu">
              <li><a href="membertype.html"><i class="fa fa-credit-card"></i> Member Type</a></li>
              <li><a href="gymtype.html"><i class="fa fa-chain"></i> Gym Type</a></li>
            </ul>
          </li>
          <li class="treeview" v-if="seen">
            <a href="#">
              <i class="fa fa-user"></i>
              <span>Staff</span>
              <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
            <ul class="treeview-menu">
              <li><a href="addstaff.html"><i class="fa fa-plus"></i> Add Staff</a></li>
              <li><a href="editstaff.html"><i class="fa fa-edit"></i> Edit Staff</a></li>
              <li><a href="stafflist.html"><i class="fa fa-list-alt"></i> Staff List</a></li>
            </ul>
          </li>
          <li class="treeview">
            <a href="#">
              <i class="fa fa-rupee"></i>
              <span>Bill</span>
              <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
            <ul class="treeview-menu">
              <li><a href="newbill.html"><i class="fa fa-plus"></i> New Bill</a></li>
              <li><a href="balancebill.html"><i class="fa fa-edit"></i> Balance Bill</a></li>
              <li><a href="renewalbill.html"><i class="fa fa-list-alt"></i> Renewal Bill</a></li>
            </ul>
          </li>
          <li class="treeview" v-if="seen">
            <a href="#">
              <i class="fa fa-pie-chart"></i>
              <span>Reports</span>
              <span class="pull-right-container">
              <i class="fa fa-angle-left pull-right"></i>
            </span>
            </a>
            <ul class="treeview-menu">
              <li><a href="#"><i class="fa fa-bar-chart"></i> Report 1</a></li>
              <li><a href="#"><i class="fa fa-bar-chart"></i> Report 2</a></li>
            </ul>
          </li>
          <li>
            <a class="logout">
              <i class="fa fa-power-off"></i> <span>Logout</span>
            </a>
          </li>
        </ul>
      </section>
      <!-- /.sidebar -->
    </aside>

  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper">
    <!-- Content Header (Page header) -->
    <section class="content-header">
      <h1>
        Dashboard
        <small>Control panel</small>
      </h1>
    </section>

    <!-- Main content -->
    <section class="content">
      <!-- Info boxes -->
      <div class="row">
        <div class="col-md-3 col-sm-6 col-xs-12">
          <a href="comingsoonexpirecustomer.html"><div class="info-box">
            <span class="info-box-icon bg-aqua"><i class="ion ion-person-add"></i></span>
            <div class="info-box-content" style="color:#000;">
              <span class="info-box-text" style="white-space:normal !important;">Coming soon<br/>Expire Customer</span>
              <span class="info-box-number" style="font-size:30px;" id="thismonthexpire"></span>
            </div>
            <!-- /.info-box-content -->
          </div></a>
          <!-- /.info-box -->
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-6 col-xs-12">
          <a href="expiredcustomer.html"><div class="info-box">
            <span class="info-box-icon bg-red"><i class="ion ion-ios-people"></i></span>
            <div class="info-box-content" style="color:#000;">
              <span class="info-box-text" style="white-space:normal !important;">Expired <br/>Customers</span>
              <span class="info-box-number" style="font-size:30px;" id="expiredcustomer"></span>
            </div>
            <!-- /.info-box-content -->
          </div></a>
          <!-- /.info-box -->
        </div>
        <!-- /.col -->

        <!-- fix for small devices only -->
        <div class="clearfix visible-sm-block"></div>

        <div class="col-md-3 col-sm-6 col-xs-12">
          <a href="paymentduecustomer.html"><div class="info-box">
            <span class="info-box-icon bg-green"><i class="ion ion-person-stalker"></i></span>
            <div class="info-box-content" style="color:#000;">
              <span class="info-box-text" style="white-space:normal !important;">Payment due <br/>customers</span>
              <span class="info-box-number" style="font-size:30px;" id="paymentduecustomer"></span>
            </div>
            <!-- /.info-box-content -->
          </div></a>
          <!-- /.info-box -->
        </div>
        <!-- /.col -->
        <div class="col-md-3 col-sm-6 col-xs-12">
          <a href="customerlist.html"><div class="info-box">
            <span class="info-box-icon bg-yellow"><i class="ion ion-ios-people-outline"></i></span>
            <div class="info-box-content" style="color:#000;">
              <span class="info-box-text" style="white-space:normal !important;">Total customers</span>
              <span class="info-box-number" style="font-size:30px;" id="allcustomer"></span>
            </div>
            <!-- /.info-box-content -->
          </div></a>
          <!-- /.info-box -->
        </div>
        <!-- /.col -->
      </div>
      <!-- /.row -->
      <!-- Main row -->
      <div class="row">
        <!-- Left col -->
        <section class="col-lg-7 connectedSortable">

          <!-- USERS LIST -->
              <div class="box box-danger">
                <div class="box-header with-border">
                  <h3 class="box-title">Latest Members</h3>

                  <div class="box-tools pull-right">
                    <span class="label label-danger" id="membercount"></span>
                    <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                    </button>
                  </div>
                </div>
                <!-- /.box-header -->
                <div class="box-body no-padding">
                  <ul class="users-list clearfix" id="memberlist">

                  </ul>
                  <!-- /.users-list -->
                </div>
                <!-- /.box-body -->
                <!--<div class="box-footer text-center">
                  <a href="javascript:void(0)" class="uppercase">View All Users</a>
                </div>-->
                <!-- /.box-footer -->
              </div>

          <!-- TO DO List -->
          <div class="box box-primary">
            <div class="box-header">
              <i class="ion ion-clipboard"></i>
              <h3 class="box-title">To Do List</h3>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <ul class="todo-list" id="opentodolist">
                
              </ul>
            </div>
            <!-- /.box-body -->
            <div class="box-footer clearfix no-border">
              <button type="button" class="btn btn-default pull-right" data-toggle="modal" data-target="#addtodolist"><i class="fa fa-plus"></i> Add item</button>
            </div>
          </div>
          <!-- /.box -->

        </section>
        <!-- /.Left col -->
        <!-- right col (We are only adding the ID to make the widgets sortable)-->
        <section class="col-lg-5 connectedSortable">

          <!-- PRODUCT LIST -->
          <div class="box box-primary box-warning">
            <div class="box-header with-border">
              <i class="fa fa-calendar"></i>
              <h3 class="box-title">Birthday Reminder</h3>

              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>                
              </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <ul class="products-list product-list-in-box" id="birthdayreminder">

              </ul>
            </div>
            <!-- /.box-body -->
            <!--<div class="box-footer text-center">
              <a href="javascript:void(0)" class="uppercase">View All</a>
            </div>-->
            <!-- /.box-footer -->
          </div>
          <!-- /.box -->

          <div class="box box-success">
            <div class="box-header with-border">
              <h3 class="box-title">Customer Chart</h3>

              <div class="box-tools pull-right">
                <button type="button" class="btn btn-box-tool" data-widget="collapse"><i class="fa fa-minus"></i>
                </button>
              </div>
            </div>
            <!-- /.box-header -->
            <div class="box-body">
              <div class="row">
                <div class="col-md-8">
                  <div class="chart-responsive">
                    <canvas id="pieChart" height="150"></canvas>
                  </div>
                  <!-- ./chart-responsive -->
                </div>
                <!-- /.col -->
                <div class="col-md-4">
                  <ul class="chart-legend clearfix" id="chartmembertypelist">
                    
                  </ul>
                </div>
                <!-- /.col -->
              </div>
              <!-- /.row -->
            </div>
            <!-- /.box-body -->
            <div class="box-footer no-padding">
              <ul id="perchartmembertypelist" style="list-style:none;padding-left: 0px !important;margin-bottom:0px !important;">
                
              </ul>
            </div>
            <!-- /.footer -->
          </div>

        </section>
        <!-- right col -->
      </div>
      <!-- /.row (main row) -->

    </section>
    <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
      <strong>Copyright &copy; 2016-2017 <a href="http://matrix-gym.in" target="_blank">Matrix Fitness</a>.</strong> All
      rights reserved.
  </footer>
</div>
<!-- ./wrapper -->

<!-- Add Modal -->
<div class="modal fade" id="addtodolist" tabindex="-1" role="dialog" 
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <button type="button" class="close" 
                   data-dismiss="modal">
                       <span aria-hidden="true">&times;</span>
                       <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Add ToDo
                </h4>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body">
                <form role="form">
                  <div class="form-group">
                    <label for="addtodoname">Todo Name</label>
                      <input type="text" class="form-control"
                      id="addtodoname" placeholder="Enter Todo Name"/>
                  </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                        data-dismiss="modal">
                            Close
                </button>
                <button type="button" id="addtodobtn" class="btn btn-primary">
                    Save Todo
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Edit Modal -->
<div class="modal fade" id="edittodolist" tabindex="-1" role="dialog" 
     aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <!-- Modal Header -->
            <div class="modal-header">
                <button type="button" class="close" 
                   data-dismiss="modal">
                       <span aria-hidden="true">&times;</span>
                       <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title" id="myModalLabel">
                    Edit ToDo
                </h4>
            </div>
            
            <!-- Modal Body -->
            <div class="modal-body">
                <form role="form">

                  <div class="form-group" style="display:none;">
                    <label for="edittodoid">Todo ID</label>
                      <input type="text" class="form-control"
                      id="edittodoid" placeholder="Enter Todo ID"/>
                  </div>

                  <div class="form-group">
                    <label for="edittodoname">Todo Name</label>
                      <input type="text" class="form-control"
                      id="edittodoname" placeholder="Enter Todo Name"/>
                  </div>
            </div>
            
            <!-- Modal Footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-default"
                        data-dismiss="modal">
                            Close
                </button>
                <button type="button" id="edittodobtn" class="btn btn-primary">
                    Edit Todo
                </button>
            </div>
        </div>
    </div>
</div>


<!-- jQuery 2.2.3 -->
<script src="../plugins/jQuery/jquery-2.2.3.min.js"></script>
<!-- jQuery UI 1.11.4 -->
<script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
<script>
  $.widget.bridge('uibutton', $.ui.button);
</script>
<!-- Bootstrap 3.3.6 -->
<script src="../js/bootstrap.min.js"></script>
<!-- DataTables -->
<script src="../plugins/datatables/jquery.dataTables.min.js"></script>
<script src="../plugins/datatables/dataTables.bootstrap.min.js"></script>
<!-- Slimscroll -->
<script src="../plugins/slimScroll/jquery.slimscroll.min.js"></script>
<!-- ChartJS 1.0.1 -->
<script src="../plugins/chartjs/Chart.min.js"></script>
<!-- FastClick -->
<script src="../plugins/fastclick/fastclick.js"></script>
<script src="../plugins/vuejs/vue.js"></script>
<!-- AdminLTE App -->
<script src="../js/app.min.js"></script>

<!-- AdminLTE for demo purposes -->
<!--<script src="js/demo.js"></script>-->
<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.15.2/moment.min.js"></script>
<script src="http://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>

<script>

$(function () {

  "use strict";

  var us = true;
    if(localStorage.getItem("userrole")=="STAFF")
      us = false;

      var app3 = new Vue({
      el: '#app-3',
      data: {
      seen: us
      }
    });

    var uname = new Vue({
    el: '.uname',
    data: {
      uname: localStorage.getItem("fname")+" "+localStorage.getItem("lname")
    }
  });

  var userrole = new Vue({
    el: '.userrole',
    data: {
      userrole: localStorage.getItem("userrole")
    }
  });

  var profileimage = new Vue({
    el: '.profileimage',
    data: {
      profileimage: localStorage.getItem("profileimage")
    }
  });

  var createdat = new Vue({
    el: '.createdat',
    data: {
      createdat: localStorage.getItem("createdat")
    }
  });

  $(".uname").text(localStorage.getItem("fname")+" "+localStorage.getItem("lname"));
  $(".userrole").text(localStorage.getItem("userrole"));
  $(".profileimage").attr('src', localStorage.getItem("profileimage"));
  $(".createdat").text(localStorage.getItem("createdat"));


  $(".logout").click(function(){
    localStorage.setItem('userid', "");
    localStorage.setItem('fname', "");
    localStorage.setItem('lname', "");
    localStorage.setItem('userrole', "");
    localStorage.setItem('username', "");
    localStorage.setItem('profileimage', "");
    localStorage.setItem('createdat', "");
    window.location.href = '../index.html';
  });

  //Make the dashboard widgets sortable Using jquery UI
  $(".connectedSortable").sortable({
    placeholder: "sort-highlight",
    connectWith: ".connectedSortable",
    handle: ".box-header, .nav-tabs",
    forcePlaceholderSize: true,
    zIndex: 999999
  });
  $(".connectedSortable .box-header, .connectedSortable .nav-tabs-custom").css("cursor", "move");

  //jQuery UI sortable for the todo list
  $(".todo-list").sortable({
    placeholder: "sort-highlight",
    handle: ".handle",
    forcePlaceholderSize: true,
    zIndex: 999999
  });

  /* The todo list plugin */
  $(".todo-list").todolist({
    onCheck: function (ele) {
      window.console.log("The element has been checked");
      return ele;
    },
    onUncheck: function (ele) {
      window.console.log("The element has been unchecked");
      return ele;
    }
  });


    //-------------
  //- PIE CHART - 
  //-------------
  // Get context with jQuery - using jQuery's .get() method.
  var pieChartCanvas = $("#pieChart").get(0).getContext("2d");
  var pieChart = new Chart(pieChartCanvas);
  var PieData = [];
  var pieOptions = {
    //Boolean - Whether we should show a stroke on each segment
    segmentShowStroke: true,
    //String - The colour of each segment stroke
    segmentStrokeColor: "#fff",
    //Number - The width of each segment stroke
    segmentStrokeWidth: 1,
    //Number - The percentage of the chart that we cut out of the middle
    percentageInnerCutout: 50, // This is 0 for Pie charts
    //Number - Amount of animation steps
    animationSteps: 100,
    //String - Animation easing effect
    animationEasing: "easeOutBounce",
    //Boolean - Whether we animate the rotation of the Doughnut
    animateRotate: true,
    //Boolean - Whether we animate scaling the Doughnut from the centre
    animateScale: false,
    //Boolean - whether to make the chart responsive to window resizing
    responsive: true,
    // Boolean - whether to maintain the starting aspect ratio or not when responsive, if set to false, will take up entire container
    maintainAspectRatio: false,
    //String - A legend template
    //legendTemplate: "<ul class=\"<%=name.toLowerCase()%>-legend\"><% for (var i=0; i<segments.length; i++){%><li><span style=\"background-color:<%=segments[i].fillColor%>\"></span><%if(segments[i].label){%><%=segments[i].label%><%}%></li><%}%></ul>",
    //String - A tooltip template
    tooltipTemplate: "<%=label%> users count -- <%=value %>"
  };
  //Create pie or douhnut chart
  // You can switch between pie and douhnut using the method below.
  //pieChart.Doughnut(PieData, pieOptions);
  //-----------------
  //- END PIE CHART -
  //-----------------  


  $("#overlay").show();


  function loadlasteightmember(){
    $.get(domainUrl + 'customer/getlasteightcustomer', function(res, status){

      $("#memberlist").empty();
      $("#membercount").empty();
      $("#membercount").append(res.length+' New Members');

      for (var i = 0; i < res.length; i++) {
        var cphoto = res[i].cphoto;
        if(cphoto=="" || cphoto==" ")
          cphoto = "../img/default.png";

        $("#memberlist").append('<li><a href="singlecustomer.html?cid='+ res[i].cid +'"><img src="'+cphoto+'" alt="Customer Image"></a>'+
                                '<a class="users-list-name" style="color:#3c8dbc;" href="singlecustomer.html?cid='+ res[i].cid +'">'+ res[i].fname +' '+ res[i].lname +
                                '</a><span class="users-list-date">'+ moment(res[i].joindate).format("YYYY-MM-DD") +'</span></li>');
      }

      
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadBirthdayReminder(){
    var today = new Date();
    var month = today.getMonth()+1;
    var day = moment(today).format("DD");
    $.get(domainUrl + 'customer/getallthismonthbirthdaycustomer?month='+month+'&day='+day, function(res, status){

      $("#birthdayreminder").empty();
      
      for (var i = 0; i < res.length; i++) {
        var cphoto = res[i].cphoto;
        if(cphoto=="" || cphoto==" ")
          cphoto = "../img/default.png";
        
        var x = moment(res[i].dob).format("DD")-today.getDate();

        $("#birthdayreminder").append('<li class="item"><a href="singlecustomer.html?cid='+ res[i].cid +'"><div class="product-img"><img src="'+ cphoto +'" alt="Customer Image">'
                  +'</div></a><div class="product-info"><a href="singlecustomer.html?cid='+ res[i].cid +'" class="product-title">'+
                  res[i].fname +' '+ res[i].lname +'</a><span class="product-description">'+
                  moment(res[i].dob).format("YYYY-MM-DD") +'</span><span>'+ x +' days more...</span></div></li>');
      }
      
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadChart(){
    $.get(domainUrl + 'customer/getmembertypechart', function(res, status){
      $("#chartmembertypelist").empty();
      $("#perchartmembertypelist").empty();
      var x = 0;
      for (var i = 0; i < res.length; i++) {
        x += res[i].value;
      }

      for (var i = 0; i < res.length; i++) {
        var z = (res[i].value / x) * 100;
        $("#chartmembertypelist").append('<li><i class="fa fa-circle-o" style="color:'+ res[i].color +'"></i> '+ res[i].label +'</li>');
        $("#perchartmembertypelist").append('<li style="padding: 10px 10px;border-bottom: 1px solid #ccc;">'+
        '<span>'+ res[i].label +'</span> <span class="pull-right text-yellow">'+ z.toFixed(2) + ' %</span></a></li>');
      }

      PieData=res;
      pieChart.Doughnut(PieData, pieOptions);
      
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadAllCustomer(){
    $.get(domainUrl + 'customer/getallcustomer', function(res, status){
      $("#allcustomer").empty();
      $("#allcustomer").append(res.length);
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadExpiredCustomer(){
    var today = new Date();
    var t = moment(today).format("YYYY-MM-DD")
    $.get(domainUrl + 'customer/getallexpiredcustomer?today='+ t, function(res, status){
      $("#expiredcustomer").empty();
      $("#expiredcustomer").append(res.length);
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadThisMonthExpiredCustomer(){
    var today = new Date();
    var month = today.getMonth()+1;
    var year = today.getFullYear();
    var t = moment(today).format("YYYY-MM-DD")
    $.get(domainUrl + 'customer/getallthismonthexpirecustomer?year='+ year +'&month='+ month +'&today='+t, function(res, status){
      $("#thismonthexpire").empty();
      $("#thismonthexpire").append(res.length);
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  function loadPaymentDueCustomer(){
    $.get(domainUrl + 'customer/getallbalanceduecustomer', function(res, status){
      $("#paymentduecustomer").empty();
      $("#paymentduecustomer").append(res.length);
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  loadlasteightmember();
  loadBirthdayReminder();
  loadChart();
  loadAllCustomer();
  loadExpiredCustomer();
  loadThisMonthExpiredCustomer();
  loadPaymentDueCustomer();

  function loadTodoList(){
    $.get(domainUrl + 'todo/getallopentodo', function(res, status){

      $("#opentodolist").empty();
      
      for (var i = 0; i < res.length; i++) {
        $("#opentodolist").append('<li><span class="handle"><i class="fa fa-ellipsis-v"></i><i class="fa fa-ellipsis-v"></i></span>'
                  +'<span class="text">'+ res[i].todoname +'</span><small class="label label-success"><i class="fa fa-clock-o"></i> '+ moment(res[i].createdat).format("YYYY-MM-DD HH:mm:ss") +'</small>'
                  +'<div class="tools"><i class="fa fa-edit" onclick="todoedit('+ res[i].todoid +')"></i><i class="fa fa-check-square-o" onclick="todostatuschange('+ res[i].todoid +')"></i></div></li>');
      }

      $("#overlay").hide();
      
    }).fail(function(){
      $("#overlay").hide();
      toastr.error('Please check Network...','Error...')
    });
  }

  loadTodoList();


  $("#addtodobtn").click(function(){
      var today = new Date();
      var params = {
                  todoname: $("#addtodoname").val(),
                  createdat:moment(today).format("YYYY-MM-DD HH:mm:ss"),
                  updatedat:moment(today).format("YYYY-MM-DD HH:mm:ss")
                }

                $("#overlay").show();

                $.post(domainUrl + 'todo/addtodo',params, function(res, status){
                  if(res=="success"){
                    toastr.success('Added Successfully...!', 'ToDo')
                    $("#addtodoname").val("");
                    loadTodoList();
                    $('#addtodolist').modal('hide');
                  }else{
                    //alert("Error.....");
                    toastr.success('Error...!', 'ToDo')
                  }
                  $("#overlay").hide();
                }).fail(function(){
                  $("#overlay").hide();
                    toastr.error('Please check Network...','Error...')
                });
    });

    $("#edittodobtn").click(function(){
      var today = new Date();
      var params = {
                  todoid: $("#edittodoid").val(),
                  todoname: $("#edittodoname").val(),
                  updatedat:moment(today).format("YYYY-MM-DD HH:mm:ss")
                }

                $("#overlay").show();

                $.post(domainUrl + 'todo/edittodo',params, function(res, status){
                  if(res=="success"){
                    toastr.success('Edit Successfully...!', 'ToDo')
                    $("#edittodoid").val("");
                    $("#edittodoname").val("");
                    loadTodoList();
                    $('#edittodolist').modal('hide');
                  }else{
                    //alert("Error.....");
                    toastr.success('Error...!', 'ToDo')
                  }
                  $("#overlay").hide();
                }).fail(function(){
                  $("#overlay").hide();
                    toastr.error('Please check Network...','Error...')
                });
    });

});


function loadTodoListAfter(){
    $.get(domainUrl + 'todo/getallopentodo', function(res, status){

      $("#opentodolist").empty();
      
      for (var i = 0; i < res.length; i++) {
        $("#opentodolist").append('<li><span class="handle"><i class="fa fa-ellipsis-v"></i><i class="fa fa-ellipsis-v"></i></span>'
                  +'<span class="text">'+ res[i].todoname +'</span><small class="label label-success"><i class="fa fa-clock-o"></i> '+ moment(res[i].createdat).format("YYYY-MM-DD HH:mm:ss") +'</small>'
                  +'<div class="tools"><i class="fa fa-edit" onclick="todoedit('+ res[i].todoid +')"></i><i class="fa fa-check-square-o" onclick="todostatuschange('+ res[i].todoid +')"></i></div></li>');
      }
      
    }).fail(function(){
      toastr.error('Please check Network...','Error...')
    });
  }

    function todostatuschange(x){

      if(confirm("Do you want to move this todo to finish state ?")){
        $("#overlay").show();
        $.get(domainUrl + 'todo/closetodo?todoid='+ x, function(res, status){
             toastr.success('Status changed Successfully...!', 'ToDo')
             loadTodoListAfter();
             $("#overlay").hide();
        }).fail(function(){
          $("#overlay").hide();
            toastr.error('Please check Network...','Error...')
        });
        
      }
    }

    function todoedit(x){
      $("#overlay").show();
      $.get(domainUrl + 'todo/gettodobyid?todoid='+ x, function(res, status){
             $("#edittodoid").val(res[0].todoid);
             $("#edittodoname").val(res[0].todoname);
             $('#edittodolist').modal('show');
             $("#overlay").hide();
        }).fail(function(){
          $("#overlay").hide();
            toastr.error('Please check Network...','Error...')
        });
    }
  
</script>

<!-- AdminLTE custom app js -->
<!--<script src="../js/cust-app.min.js"></script>-->

</body>
</html>
